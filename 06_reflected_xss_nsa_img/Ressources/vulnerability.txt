Reflected XSS - NSA Image

While checking images from the home page, we can see that the nsa one is a link to:
	?page=media&src=nsa
By clicking on it, we can see that the data sent through the URI is used to generate the content
This means an attacker can create a custom link which contains his malicious code
He can then send this url to other users
By clicking on this link, the malicious code could be executed locally on the target browser
In our case, we can use the argument "src":
By default, if not provided, the mime type of such data is text/plain as it is by default in our example with "nsa"
However this mime type can be modified and we can decide to say it's HTML code instead of plain text
	So let's try it by submitting:
		?page=media&src=data:text/html,<script>alert(1)</script>
			=> It works, there is a refected xss but no flag, let's dig deeper
By default, base64 encoding can be used to send binary through in this context
Hence we can convert our query to base 64
	So let's try it by submitting:
		?page=media&src=data:text/html;base64,PHNjcmlwdD5hbGVydChkb2N1bWVudC5jb29raWUpPC9zY3JpcHQ+
			=> This time the reflected xss doesnt show the alert but we get the flag

PROTECTION
	There can be an input validation
	In this case we could also enforce the mime type to be plain text		
